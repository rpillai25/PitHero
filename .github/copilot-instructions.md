# GitHub Copilot Instructions – Pit Hero Event-Driven Version

- The project is written in C# using **FNA + Nez** (not MonoGame).
- Game runs as a **horizontal strip** at bottom of screen (borderless, always-on-top, click-through optional)
- Virtual resolution: 1920×360
- All world logic is **event-driven**:
  - Every action (hero spawn, move, death, building placement, pit event) is logged as an Event.
  - Systems subscribe to events and deterministically update `WorldState`.
  - Replays are generated by applying events in order.
- ECS pattern using **Nez framework**:
  - `WorldState` wraps `Nez.Scene` and contains all entities and global variables
  - `EventLog` stores timestamped events
  - All components inherit from `Nez.Component`
  - Systems like `HeroSystem`, `PitSystem`, `TownSystem`, and `ReplaySystem` process events
  - Use `Nez.RenderableComponent` or custom extensions for rendering
- Architecture constraints:
  - **Single Hero**: There is only ever 1 active hero at a time (no multiple heroes)
  - **Single Pit**: There is only ever 1 active pit with configured size (not random size)
  - **Individual Components**: Each component class should be in its own file
  - **MSTest**: Use standard MSTest framework for testing, not custom test runners
  - **Nez Boilerplate**: Keep Program.cs as standard Nez boilerplate (FNA setup)
- Rendering/UI:
  - Live strip renders current `WorldState`
  - Replay overlay renders events from `EventLog` without altering live state
- Keep all constants (sizes, positions, movement speeds) in `GameConfig.cs`
- Maintain integer scaling for pixel-perfect rendering
- Hero movement, AI, pit crystal logic, and building effects should always operate via events
- Ensure the game continues running in idle while the player interacts with other desktop apps
- **Build Requirements**: 
  - Run `getFNA.sh` with automatic "yes" response before building to initialize FNA submodule and dependencies
    - cd /home/runner/work/PitHero/PitHero && echo "y" | ./getFNA.sh
  - Both FNA and Nez must be properly initialized before building.  Check that both subfolders are there.
- **Nez Architecture Compliance**:
  - Game1 should inherit from `Nez.Core`, not override Draw() or Update() methods
  - Scenes should inherit from `Nez.Scene` and override Initialize() for setup
  - Use Nez.Time class instead of custom GameTime management
  - WorldState should be separate from Scene logic
  - All components under ECS/Components/, Scenes under ECS/Scenes/
- Copilot should generate:
  - Event classes and handlers
  - Systems that process events deterministically
  - UI components that subscribe to world state
  - Replay overlay logic that replays events from the log

